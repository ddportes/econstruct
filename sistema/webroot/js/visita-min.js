$(document).ready(function(){$("#clienteId").on("change",function(){var e=$(this).val();$.ajax({type:"GET",url:urlVisit+e,ProcessData:!0,data:{hash:hashVisit},success:function(e){if(""==e)$("#nomePessoa").val(""),$("#telefoneCliente").val(""),$("#emailCliente").val(""),$("#cpfPessoa").val(""),$("#sexoPessoa").val(""),$("#rgPessoa").val(""),$("#estadoCivilPessoa").val(""),$("#filhosPessoa").val(""),$("#conjugeHiddenPessoa").val(""),$("#cepCliente").val(""),$("#logradouroCliente").val(""),$("#numeroCliente").val(""),$("#bairroCliente").val(""),$("#complementoCliente").val(""),$("#cidadeCliente").val(""),$("#estadoCliente").val(""),$("#nomeSocialPessoa").val(""),$("#observacaoCliente").val(""),$("#descricaoProjeto").val(""),$("#detalhesProjeto").val(""),$("#custoEstimadoProjeto").val(""),$("#observacaoProjeto").val(""),$("#pessoa_id").val(""),$("#projeto_id").val(""),$("#cliente_id").val("");else{var a=jQuery.parseJSON(e);telefone="",a.pessoa.contatos.forEach(function(e,a){"telefone"==e.tipo&&(""==telefone?telefone=e.valor:telefone=telefone+"/"+e.valor)}),email="",a.pessoa.contatos.forEach(function(e,a){"email"==e.tipo&&(""==email?email=e.valor:email=email+"/"+e.valor)}),endereco="",a.pessoa.enderecos.forEach(function(e,a){endereco=e}),$("#nomePessoa").val(a.pessoa.nome),$("#telefoneCliente").val(telefone),$("#emailCliente").val(email),$("#cpfPessoa").val(a.pessoa.cpf_cnpj),$("#sexoPessoa").val(a.pessoa.sexo),$("#rgPessoa").val(a.pessoa.rg),$("#estadoCivilPessoa").val(a.pessoa.estado_civil),$("#filhosPessoa").val(a.pessoa.filhos),$("#conjugeHiddenPessoa").val(a.pessoa.conjuge_id),$("#cepCliente").val(endereco.cep),$("#logradouroCliente").val(endereco.logradouro),$("#numeroCliente").val(endereco.numero),$("#bairroCliente").val(endereco.bairro),$("#complementoCliente").val(endereco.complemento),$("#cidadeCliente").val(endereco.cidade),$("#estadoCliente").val(endereco.estado),$("#nomeSocialPessoa").val(a.pessoa.nome_social),$("#observacaoCliente").val(a.pessoa.observacao),$("#descricaoProjeto").val(a.projeto.descricao),$("#detalhesProjeto").val(a.projeto.detalhes),$("#custoEstimadoProjeto").val(a.projeto.custo_estimado),$("#observacaoProjeto").val(a.projeto.observacao),$("#pessoa_id").val(a.pessoa.id),$("#projeto_id").val(a.projeto.id),$("#cliente_id").val(a.id)}},contentType:"application/json; charset=utf-8"})});var e=function(e){return 11===e.replace(/\D/g,"").length?"(00) 00000-0000":"(00) 0000-00009"},a={onKeyPress:function(a,o,l,s){l.mask(e.apply({},arguments),s)}};function o(){$("#logradouroCliente").val(""),$("#bairroCliente").val(""),$("#cidadeCliente").val(""),$("#estadoCliente").val("")}$("#telefoneCliente").mask(e,a),$("#erro_email").hide(),$("#emailCliente").on("blur",function(){var e=$("#emailCliente").val();!/^.+@.+\..{2,}$/.test(e)||e.match(/[\(\)\<\>\,\;\:\\\/\"\[\]]/)?0==e.length?($("#salvar").prop("disabled",!1),$("#erro_email").hide()):($("#erro_email").show().removeClass("alert alert-success alert-dismissible fade show").addClass("alert alert-danger alert-dismissible fade show").text("Por favor, informe um email válido."),$("#erro_email").append('<button onclick="$(\'#erro_email\').hide();" type="button" class="close" aria-label="Close"><span aria-hidden="true">×</span></button>'),$("#salvar").prop("disabled",!0)):($("#erro_email").show().removeClass("alert alert-danger alert-dismissible fade show").addClass("alert alert-success alert-dismissible fade show").text("Email informado está correto!"),$("#erro_email").append('<button onclick="$(\'#erro_email\').hide();" type="button" class="close" aria-label="Close"><span aria-hidden="true">×</span></button>'),$("#salvar").prop("disabled",!1))}),$("#emailCliente").focus(function(){$("#salvar").prop("disabled",!1),$("#erro_email").hide()}),$("#erro_cep").hide(),$("#cepCliente").mask("00.000-000"),$("#cepCliente").blur(function(){var e=$(this).val().replace(/\D/g,"");if(""!=e){/^[0-9]{8}$/.test(e)?($("#logradouroCliente").val("..."),$("#bairroCliente").val("..."),$("#cidadeCliente").val("..."),$("#estadoCliente").val("..."),$.getJSON("https://viacep.com.br/ws/"+e+"/json/?callback=?",function(e){"erro"in e?(o(),$("#erro_cep").show().removeClass("alert alert-success alert-dismissible fade show").addClass("alert alert-danger alert-dismissible fade show").text("CEP não encontrado."),$("#erro_cep").append('<button onclick="$(\'#erro_cep\').hide();" type="button" class="close" aria-label="Close"><span aria-hidden="true">×</span></button>')):($("#erro_cep").hide(),$("#logradouroCliente").val(e.logradouro),$("#bairroCliente").val(e.bairro),$("#cidadeCliente").val(e.localidade),$("#estadoCliente").val(e.uf),$("#numeroCliente").focus())})):(o(),$("#erro_cep").show().removeClass("alert alert-success alert-dismissible fade show").addClass("alert alert-danger alert-dismissible fade show").text("Formato de CEP inválido."),$("#erro_cep").append('<button onclick="$(\'#erro_cep\').hide();" type="button" class="close" aria-label="Close"><span aria-hidden="true">×</span></button>'))}else o(),$("#erro_cep").hide()}),$("#erro_cpf").hide(),$("#cpfPessoa").mask("000.000.000-00"),$("#cpfPessoa").on("blur",function(){var e=$("#cpfPessoa").val().replace(/[^0-9]/g,"").toString();if(11==e.length){var a=[];a[0]=1*e[0]+2*e[1]+3*e[2],a[0]+=4*e[3]+5*e[4]+6*e[5],a[0]+=7*e[6]+8*e[7]+9*e[8],a[0]=a[0]%11,a[0]=a[0]%10,a[1]=1*e[1]+2*e[2]+3*e[3],a[1]+=4*e[4]+5*e[5]+6*e[6],a[1]+=7*e[7]+8*e[8]+9*a[0],a[1]=a[1]%11,a[1]=a[1]%10,a[0]!=e[9]||a[1]!=e[10]?($("#erro_cpf").show().removeClass("alert alert-success alert-dismissible fade show").addClass("alert alert-danger alert-dismissible fade show").text("CPF Inválido: "+e),$("#erro_cpf").append('<button onclick="$(\'#erro_cpf\').hide();" type="button" class="close" aria-label="Close"><span aria-hidden="true">×</span></button>'),$("#salvar").prop("disabled",!0)):($("#erro_cpf").show().removeClass("alert alert-danger alert-dismissible fade show").addClass("alert alert-success alert-dismissible fade show").text("CPF Válido"),$("#erro_cpf").append('<button onclick="$(\'#erro_cpf\').hide();" type="button" class="close" aria-label="Close"><span aria-hidden="true">×</span></button>'),$("#salvar").prop("disabled",!1))}else 0!=e.length?($("#erro_cpf").show().removeClass("alert alert-success alert-dismissible fade show").addClass("alert alert-danger alert-dismissible fade show").text("CPF Inválido: "+e),$("#erro_cpf").append('<button onclick="$(\'#erro_cpf\').hide();" type="button" class="close" aria-label="Close"><span aria-hidden="true">×</span></button>'),$("#salvar").prop("disabled",!0)):($("#salvar").prop("disabled",!1),$("#erro_cpf").hide())}),$("#custoEstimadoProjeto").maskMoney({prefix:"R$ ",decimal:",",thousands:"."})});